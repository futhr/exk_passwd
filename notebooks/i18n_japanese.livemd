# Japanese Password Generation with ExkPasswd

```elixir
Mix.install([
  {:exk_passwd, "~> 0.1.0"}
])
```

## Introduction

This notebook demonstrates how to generate **memorable Japanese passwords** that output as **ASCII Romaji** for universal keyboard compatibility.

### The Problem

Most password systems worldwide (including in Japan) require ASCII-only passwords, but:
- Japanese users want memorable passwords in their native language
- Typing Japanese requires specific input methods (Hiragana/Katakana)
- International travel means accessing accounts on non-Japanese keyboards

### The Solution

1. **Dictionary**: Japanese words (memorable for Japanese speakers)
2. **Transform**: Romaji romanization (ASCII output)
3. **Result**: Typeable on any keyboard, memorable in Japanese

---

## Setup: Load Japanese Dictionary

```elixir
# Common Japanese words in Hiragana
japanese_words = [
  "ã•ãã‚‰",   # Cherry blossom
  "ã‚„ã¾",     # Mountain
  "ã†ã¿",     # Sea
  "ãã‚‰",     # Sky
  "ã‹ãœ",     # Wind
  "ã²ã‹ã‚Š",   # Light
  "ã»ã—",     # Star
  "ã¤ã",     # Moon
  "ãŸã„ã‚ˆã†", # Sun
  "ã¯ã‚‹",     # Spring
  "ãªã¤",     # Summer
  "ã‚ã",     # Autumn
  "ãµã‚†",     # Winter
  "ã¯ãª",     # Flower
  "ã",       # Tree
  "ã¿ãš",     # Water
  "ã‚ã‚",     # Rain
  "ã‚†ã",     # Snow
  "ãã‚‚",     # Cloud
  "ã«ã˜",     # Rainbow
  "ã¨ã‚‚ã ã¡"  # Friend
]

# Load into ExkPasswd
ExkPasswd.Dictionary.load_custom(:japanese, japanese_words)

IO.puts("âœ“ Loaded #{length(japanese_words)} Japanese words")
```

## Configure Password Generation

```elixir
config = ExkPasswd.Config.new!(
  # Use Japanese dictionary
  dictionary: :japanese,

  # Japanese words are typically 2-5 characters
  word_length: 2..5,

  # Override English default (4-10) to allow shorter words
  word_length_bounds: 1..10,

  # Use 3 words for good memorability and security
  num_words: 3,

  # ASCII separator (compatible everywhere)
  separator: "-",

  # Add digits for additional entropy
  digits: {2, 2},

  # No padding (keep it clean)
  padding: %{char: "", before: 0, after: 0, to_length: 0},

  # No case transforms (Hiragana has no uppercase/lowercase)
  case_transform: :none,

  # Apply Romaji transform for ASCII output
  meta: %{
    transforms: [%ExkPasswd.Transform.Romaji{}]
  }
)

IO.puts("âœ“ Configuration created")
```

## Generate Passwords

```elixir
IO.puts("\n=== Generated Passwords ===\n")

for i <- 1..10 do
  password = ExkPasswd.generate(config)
  IO.puts("#{i}. #{password}")
end
```

## How It Works

The generation process:

```mermaid
graph LR
    A[Japanese Words] --> B[Random Selection]
    B --> C[ã•ãã‚‰-ã‚„ã¾-ã†ã¿]
    C --> D[Romaji Transform]
    D --> E[sakura-yama-umi]
    E --> F[Add Digits]
    F --> G[23-sakura-yama-umi-78]
```

**Internal representation:** `ã•ãã‚‰-ã‚„ã¾-ã†ã¿`
**Output:** `23-sakura-yama-umi-78`

âœ… **Memorable:** Japanese speaker remembers the meaning
âœ… **Compatible:** Works on any keyboard, any system
âœ… **Secure:** Cryptographically random word selection

## Security Analysis

```elixir
sample_password = ExkPasswd.generate(config)

IO.puts("\n=== Security Analysis ===")
IO.puts("Sample password: #{sample_password}")
IO.puts("")
IO.puts("Dictionary size: #{length(japanese_words)} words")
IO.puts("Entropy per word: #{Float.round(:math.log2(length(japanese_words)), 2)} bits")
IO.puts("Total word entropy: #{Float.round(:math.log2(length(japanese_words)) * 3, 2)} bits")
IO.puts("Additional entropy: Digits (2 before + 2 after) = ~13.3 bits")
IO.puts("Total entropy: ~#{Float.round(:math.log2(length(japanese_words)) * 3 + 13.3, 1)} bits")
IO.puts("")
IO.puts("Status: Good security for most accounts")
IO.puts("Recommendation: Add more words to dictionary for higher security")
```

## Test Romaji Transform

Test the Romaji transform with both Hiragana and Katakana:

```elixir
transform = %ExkPasswd.Transform.Romaji{}

# Test Hiragana
IO.puts("\n=== Hiragana â†’ Romaji ===\n")

hiragana_tests = [
  {"ã•ãã‚‰", "sakura"},
  {"ã‚„ã¾", "yama"},
  {"ã†ã¿", "umi"},
  {"ãã‚‰", "sora"},
  {"ã‹ãœ", "kaze"}
]

for {hiragana, expected} <- hiragana_tests do
  result = ExkPasswd.Transform.apply(transform, hiragana, nil)
  match = if result == expected, do: "âœ“", else: "âœ—"
  IO.puts("#{match} #{hiragana} â†’ #{result} (expected: #{expected})")
end

# Test Katakana (including modern loanword features)
IO.puts("\n=== Katakana â†’ Romaji ===\n")

katakana_tests = [
  {"ã‚µã‚¯ãƒ©", "sakura"},
  {"ãƒ¤ãƒ", "yama"},
  {"ã‚¦ãƒŸ", "umi"},
  {"ã‚³ãƒ¼ãƒ’ãƒ¼", "koohii"},  # Long vowel marker now properly handled
  {"ãƒ©ãƒ¼ãƒ¡ãƒ³", "raamen"},   # Long vowel marker
  {"ãƒ•ã‚¡ã‚¤ãƒ«", "fairu"},   # Modern loanword: file
  {"ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼", "paatii"}, # Modern loanword: party
  {"ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦", "windou"}, # Modern loanword: window
  {"ãƒã‚§ãƒƒã‚¯", "chekku"}   # Modern loanword: check
]

for {katakana, expected} <- katakana_tests do
  result = ExkPasswd.Transform.apply(transform, katakana, nil)
  match = if result == expected, do: "âœ“", else: "âœ—"
  IO.puts("#{match} #{katakana} â†’ #{result} (expected: #{expected})")
end
```

## Modern Japanese Loanwords

ExkPasswd now supports **extended Katakana** for foreign words! This is great for tech-savvy Japanese users:

```elixir
# Dictionary with modern Katakana loanwords
loanword_dictionary = [
  "ãƒ•ã‚¡ã‚¤ãƒ«",     # File
  "ãƒ•ã‚©ãƒ«ãƒ€",     # Folder
  "ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼", # Computer
  "ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼",   # Party
  "ã‚³ãƒ¼ãƒ’ãƒ¼",     # Coffee
  "ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦",   # Window
  "ãƒã‚§ãƒƒã‚¯",     # Check
  "ã‚·ã‚§ã‚¢",       # Share
  "ãƒ‡ã‚£ã‚¹ã‚¯",     # Disk
  "ãƒ´ã‚¡ã‚¤ã‚ªãƒªãƒ³"  # Violin (v-sound)
]

ExkPasswd.Dictionary.load_custom(:japanese_loanwords, loanword_dictionary)

loanword_config = ExkPasswd.Config.new!(
  dictionary: :japanese_loanwords,
  word_length: 2..8,
  word_length_bounds: 1..15,
  num_words: 3,
  separator: "-",
  digits: {2, 2},
  padding: %{char: "", before: 0, after: 0, to_length: 0},
  case_transform: :none,
  meta: %{transforms: [%ExkPasswd.Transform.Romaji{}]}
)

IO.puts("\n=== Modern Loanword Passwords ===\n")

for i <- 1..5 do
  password = ExkPasswd.generate(loanword_config)
  IO.puts("#{i}. #{password}")
end

IO.puts("\nğŸ’¡ These passwords use modern Japanese vocabulary that tech users will find familiar!")
```

## Mixed Script Support

ExkPasswd handles both Hiragana and Katakana seamlessly:

```elixir
# Dictionary with mixed scripts
mixed_words = [
  "ã•ãã‚‰",     # Hiragana - Cherry blossom
  "ã‚µã‚¯ãƒ©",     # Katakana (same word)
  "ã‚„ã¾",       # Hiragana - Mountain
  "ãƒ¤ãƒ",       # Katakana
  "ã‚³ãƒ¼ãƒ’ãƒ¼",   # Katakana - Coffee (loanword)
  "ãƒ©ãƒ¼ãƒ¡ãƒ³",   # Katakana - Ramen
  "ãŠã¡ã‚ƒ",     # Hiragana - Tea
  "ã™ã—",       # Hiragana - Sushi
  "ãƒ•ã‚¡ã‚¤ãƒ«",   # Katakana - File (modern loanword)
  "ã‚¦ã‚§ãƒ–"      # Katakana - Web (modern loanword)
]

ExkPasswd.Dictionary.load_custom(:japanese_mixed, mixed_words)

mixed_config = ExkPasswd.Config.new!(
  dictionary: :japanese_mixed,
  word_length: 2..5,
  word_length_bounds: 1..10,
  num_words: 3,
  separator: "-",
  digits: {2, 2},
  padding: %{char: "", before: 0, after: 0, to_length: 0},
  case_transform: :none,
  meta: %{transforms: [%ExkPasswd.Transform.Romaji{}]}
)

IO.puts("\n=== Mixed Script Passwords ===\n")

for i <- 1..5 do
  password = ExkPasswd.generate(mixed_config)
  IO.puts("#{i}. #{password}")
end
```

## Customization Examples

### More Words for Higher Security

```elixir
config_secure = ExkPasswd.Config.new!(
  dictionary: :japanese,
  word_length: 2..5,
  word_length_bounds: 1..10,
  num_words: 5,  # More words = more entropy
  separator: "-",
  digits: {3, 3},  # More digits
  padding: %{char: "", before: 0, after: 0, to_length: 0},
  case_transform: :none,
  meta: %{transforms: [%ExkPasswd.Transform.Romaji{}]}
)

IO.puts("High security password:")
IO.puts(ExkPasswd.generate(config_secure))
```

### Shorter for Website Limits

```elixir
config_short = ExkPasswd.Config.new!(
  dictionary: :japanese,
  word_length: 2..3,
  word_length_bounds: 1..10,
  num_words: 2,  # Fewer words
  separator: "",  # No separator
  digits: {2, 2},
  padding: %{char: "", before: 0, after: 0, to_length: 0},
  case_transform: :none,
  meta: %{transforms: [%ExkPasswd.Transform.Romaji{}]}
)

IO.puts("Short password:")
IO.puts(ExkPasswd.generate(config_short))
```

## Real-World Usage

### Example: Japanese User Traveling

**Scenario:** Yuki is traveling to Europe and needs to access Rakuten on a hostel computer.

**Without ExkPasswd:**
- Password: `ã•ãã‚‰ã‚„ã¾2023!`
- Problem: Hostel computer has no Japanese input method âŒ

**With ExkPasswd:**
- Password: `23-sakura-yama-umi-78`
- Memorized as: "ã•ãã‚‰ ã‚„ã¾ ã†ã¿" (Cherry Mountain Sea)
- Types on QWERTY: Easy! âœ…

---

## Romaji Pronunciation Guide

For those learning Japanese, here's how Romaji maps to pronunciation:

### Basic Characters

| Hiragana | Katakana | Romaji | Sound |
|----------|----------|--------|-------|
| ã‚ | ã‚¢ | a | "ah" |
| ã• | ã‚µ | sa | "sah" |
| ã‹ | ã‚« | ka | "kah" |
| ã‚‰ | ãƒ© | ra | "rah" |
| ã‚„ | ãƒ¤ | ya | "yah" |
| ã¾ | ãƒ | ma | "mah" |

**Example:** `ã•ãã‚‰` (sakura) = "sah-koo-rah"

### Modern Extensions (Loanwords)

| Katakana | Romaji | Use | Example Word |
|----------|--------|-----|--------------|
| ãƒ•ã‚¡ | fa | F-sounds | ãƒ•ã‚¡ã‚¤ãƒ« (file) |
| ãƒ•ã‚£ | fi | F-sounds | ãƒ•ã‚£ãƒ«ãƒ  (film) |
| ã‚¦ã‚£ | wi | W-sounds | ã‚¦ã‚£ã‚­ (wiki) |
| ã‚¦ã‚§ | we | W-sounds | ã‚¦ã‚§ãƒ– (web) |
| ãƒ´ã‚¡ | va | V-sounds | ãƒ´ã‚¡ã‚¤ã‚ªãƒªãƒ³ (violin) |
| ãƒ†ã‚£ | ti | T-sounds | ãƒ†ã‚£ãƒ¼ (tea) |
| ãƒ‡ã‚£ | di | D-sounds | ãƒ‡ã‚£ã‚¹ã‚¯ (disk) |
| ãƒã‚§ | che | CH-sounds | ãƒã‚§ãƒƒã‚¯ (check) |
| ã‚·ã‚§ | she | SH-sounds | ã‚·ã‚§ã‚¢ (share) |

### Long Vowels

The long vowel marker **ãƒ¼** duplicates the previous vowel:

- ã‚³ãƒ¼ãƒ’ãƒ¼ â†’ **koohii** (coffee) - "o" is doubled
- ãƒ©ãƒ¼ãƒ¡ãƒ³ â†’ **raamen** (ramen) - "a" is doubled
- ãƒ“ãƒ¼ãƒ« â†’ **biiru** (beer) - "i" is doubled

This ASCII-friendly approach ensures the passwords work on any keyboard!

## Key Takeaways

1. **Most systems require ASCII** - Even Japanese banks use ASCII-only passwords
2. **Memorability + Compatibility** - Japanese words transformed to Romaji
3. **Cryptographically secure** - Random selection, not predictable
4. **Works everywhere** - Any keyboard, any system, any country
5. **Mixed scripts supported** - Hiragana and Katakana both work
6. **âœ¨ NEW: Modern loanword support** - ãƒ•ã‚¡ã‚¤ãƒ«â†’fairu, ãƒ´ã‚¡ã‚¤ã‚ªãƒªãƒ³â†’vaiorin
7. **âœ¨ NEW: Proper long vowels** - ã‚³ãƒ¼ãƒ’ãƒ¼â†’koohii (not kohi)

## Advanced Features

### Kanji Detection

Want to check if your dictionary contains Kanji? Use the built-in detection:

```elixir
transform = %ExkPasswd.Transform.Romaji{}

IO.puts("\n=== Kanji Detection ===\n")

test_words = [
  {"ã•ãã‚‰", "Hiragana only"},
  {"ã‚µã‚¯ãƒ©", "Katakana only"},
  {"æ¡œ", "Kanji (cannot convert)"},
  {"æ—¥æœ¬èª", "Mixed Kanji"},
  {"ãƒ•ã‚¡ã‚¤ãƒ«", "Modern Katakana"}
]

for {word, description} <- test_words do
  has_kanji = ExkPasswd.Transform.Romaji.contains_kanji?(word)
  status = if has_kanji, do: "âš ï¸ Contains Kanji", else: "âœ“ OK"
  IO.puts("#{status} - #{word} (#{description})")
end

IO.puts("\nğŸ’¡ Tip: Convert Kanji to Hiragana/Katakana before using in your dictionary!")
```

## Next Steps

- Add more Japanese words to your dictionary for higher entropy
- Use modern Katakana loanwords for tech-themed passwords
- Try Chinese with Pinyin: See `notebooks/i18n_chinese.livemd`
- Check your dictionaries for Kanji using `contains_kanji?/1`
- Build custom transforms for other languages
- Integrate into your password manager workflow

## Technical Notes

### Romanization Style

ExkPasswd uses **Modified Hepburn with WÄpuro conventions** - the same style used by Japanese IMEs (Input Method Editors). This means:

- Output matches what Japanese speakers would type on QWERTY keyboards
- Long vowels use doubled letters (koohii) not macrons (kÅhÄ«)
- Special combinations for foreign sounds (fa, wi, va, ti, etc.)
- Sokuon (ã£) properly doubles consonants (ãŒã£ã“ã† â†’ gakkou)

### Supported Features

âœ… All Hiragana characters
âœ… All Katakana characters
âœ… Extended Katakana (ãƒ•ã‚¡, ã‚¦ã‚£, ãƒ´ã‚¡, ãƒ†ã‚£, etc.)
âœ… Long vowel marker (ãƒ¼)
âœ… Sokuon/gemination (ã£/ãƒƒ)
âœ… Palatalization (ãã‚ƒ/ã—ã‚ƒ/ã¡ã‚ƒ)
âœ… N-before-labials rule (ã•ã‚“ã½ â†’ sampo)
âŒ Kanji conversion (requires morphological analysis - use kana-only dictionaries)
